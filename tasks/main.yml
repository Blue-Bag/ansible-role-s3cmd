---
# tasks file for s3cmd
- name: Install dependencies
  apt:
    name: "{{ item }}"
    state: present
  with_items: s3cmd_pkgs
  
- name: Get s3cmd pkg from github
  git:
    accept_hostkey: "yes"
    repo: "{{ s3cmd_repo }}"
    dest: "{{ s3cmd_dest }}"
    version: "{{ s3cmd_version }}"
    
- name: Run installation script
  command: python setup.py install
  #sudo_user: "{{ sudo_user }}"
  args:
    chdir: "{{ s3cmd_dest }}"
    creates: "/usr/local/bin/s3cmd"
  sudo: true
    
- name: Set config files a set location
  template:
    src: "s3cfg.j2"
    dest: "{{ s3cmd_cfg_path }}"
    mode: 0644
    owner: "{{ s3cmd_cfg_owner }}"
    group: "{{ s3cmd_cfg_group }}"
